---
import { Picture } from 'astro:assets';

const {src} = Astro.props;
const classes = Astro.props.class;

const standardResolutions = [240, 480, 720, 1080, 1440, 2160, 4320]
standardResolutions.sort((a, b) => a - b)

const relevantWidths = standardResolutions.filter(size => size <= src.width)
let breakpoints = relevantWidths.map(size => `(max-width: ${size}px) ${size}px`).join(', ')

relevantWidths.push(src.width)
breakpoints += `, ${src.width}px`
---

<section class={classes}>
    <Picture 
        src={src} alt="A description of my image." 
        pictureAttributes={{ style: "width: 100%" }} 
        formats={['avif', 'webp']}
        widths={relevantWidths}
        sizes={breakpoints}
    />
    <div>
        <slot />
    </div>
</section>
<style>
    section {
        display: flex;
        overflow: hidden;
        align-items: center;
        justify-items: center;
    }
    div {
        position: absolute;
        top: 0;
        left: 0;
    }
    img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

</style>